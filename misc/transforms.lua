require 'image'

local M = {}

function M.Compose(transforms)
   return function(input)
      for _, transform in ipairs(transforms) do
         input = transform(input)
      end
      return input
   end
end

function M.ColorNormalize(meanstd)
   return function(img)
      img = img:clone()
      for i=1,3 do
         img[{{},{i},{},{}}]:add(-meanstd.mean[i])
         img[{{},{i},{},{}}]:div(meanstd.std[i])
      end
      return img
   end
end

return M
